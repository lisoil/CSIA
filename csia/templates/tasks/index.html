{% extends 'base.html' %}

{% block nav_title %} // determine if the user is a requester or certifier, display region as part of heading text
    | 
    {% if region > 0 %}Region {{region}}
    {% else %}Certifier
    {% endif %}
{% endblock %}

{% block header %}
    <h1>{% block title %}
        Tasks
     {% endblock %}</h1>
    {% if g.user and not is_certifier %}
        <a class="action" id="new-task" href="{{ url_for('tasks.submit') }}">New</a>
    {% endif %}
{% endblock %}

{% block content %}
    {% if is_certifier %}
        <h1 class="region-tasks-label">Region 1 Tasks</h1>
        {% for task in tasks if task['region'] == 1 %}
            {% include 'task_card.html' %}
        {% endfor %}

        <h1 class="region-tasks-label">Region 2 Tasks</h1>
        {% for task in tasks if task['region'] == 2 %}
            {% include 'task_card.html' %}
        {% endfor %}    
    {% else %}
        {% for task in tasks %}
            {% include 'task_card.html' %}
        {% endfor %}
    {% endif %}

    {% if is_certifier %}
        <div class="slots-container">
            <div class="region1-slots">
                <button class="slots-button-minus" onclick="updateSlots(1, 'decrement')">−</button>
                <h2>Region 1 Slots:</h2>
                <p id="region1-slots-left">{{ region1_slots_left }}</p>
                <button class="slots-button-plus" onclick="updateSlots(1, 'increment')">+</button>
            </div>
            <div class="region2-slots">
                <button class="slots-button-minus" onclick="updateSlots(2, 'decrement')">−</button>
                <h2>Region 2 Slots:</h2>
                <p id="region2-slots-left">{{ region2_slots_left }}</p>
                <button class="slots-button-plus" onclick="updateSlots(2, 'increment')">+</button>
            </div>
        </div>

    {% else %}
        <div class="slots-container">
            <div class="region1-slots">
                <h2>Region {{region}} slots:</h2>
                <p id="region{{region}}-slots-left">
                    {% if region == 1 %}{{ region1_slots_left }}
                    {% elif region == 2 %}{{ region2_slots_left }}
                    {% endif %}
                </p>
            </div>
        </div>

    {% endif %}    

    <script>
        window.is_certifier = {{ 'true' if is_certifier else 'false' }};
    </script>
    <script src="{{ url_for('static', filename='index.js') }}"></script>


{% endblock %}